include _head.jade

script(src="js/app.js")

script.
    var common = require("js/common.js");
    var ds2 = require("js/ds_two.js");

div.ds2_main
    div(class="heading")
        h1="Devil Survivor 2 Record Break Save Editor"

    div(class="save_up")
        button(class="upload", onclick="save_input.click()")="Upload save"
            input(id="ds2_save", class="upload", type='file', name="files[]")
        span(id='warning', class="warning")="WARNING: Be sure to backup your save file!"
        button(class="save", onclick="ds2.saveNew()")="Save to disk"
        script.
            var save_input = document.getElementById('ds2_save')
            save_input.addEventListener('change', ds2.saveLoad, false);
            //Add drag-and-drop
            document.addEventListener('dragover', common.handleDragOver, false);
            document.addEventListener('drop', ds2.saveLoad, false);

    form(id="macca", class="text_box", action="", onsubmit="return false")
        label(for="macca_input")="Macca"
        input(id="macca_input" disabled)

    h2(class="title")="Party"
    ul(class="party_tab")
        li
            a(href="#", class="active", onclick="open_tab(event, '1')")="Member 1"
        li
            a(href="#", onclick="open_tab(event, '2')")="Member 2"
        li
            a(href="#", onclick="open_tab(event, '3')")="Member 3"
        li
            a(href="#", onclick="open_tab(event, '4')")="Member 4"

    script.
        function open_tab(ev, idx_to_show) {
            var form = document.getElementById('member_'+idx_to_show);

            if (!form.className.includes('hidden')) {
                return;
            }

            for (var idx = 1; idx < 5; idx++) {
                var iter_form = document.getElementById('member_'+idx);
                if (!iter_form.className.includes('hidden')) {
                    iter_form.className += ' hidden';
                    break;
                }
            }

            var tab = ev.target.parentElement.parentElement;
            for (var idx = 0; idx < 4; idx++) {
                tab.children[idx].children[0].className = tab.children[idx].children[0].className.replace(/ *active/, "");
            }

            ev.target.className += ' active';
            form.className = form.className.replace(' hidden', '');
        }

    - each idx in ['1', '2', '3', '4']
        if idx === '1'
            - var class_name = "text_box party_member"
        else
            - var class_name = "text_box party_member hidden"
        form(class=class_name, id="member_"+idx)
            - each item in ['exp', 'hp', 'mp', 'str', 'mag', 'vit', 'agi', 'move']
                div
                    label(for=item)=item.toUpperCase()
                    input(id=item disabled)


